services:
  clawdbot:
    build: .
    container_name: clawdbot_sandbox
    privileged: true  # Dá superpoderes ao container
    cap_add:
      - ALL  # Adiciona todas as capabilities
    volumes:
      # Persist Clawdbot configuration (local sandbox)
      - ./data/clawdbot:/root/.clawdbot
      # Persist Gemini CLI credentials (local sandbox)
      - ./data/gemini:/root/.gemini
      # Persist workspace data (local sandbox)
      - ./data/workspace:/root/clawd
      # Cache para apt/pip (acelera instalações)
      - apt-cache:/var/cache/apt
      - pip-cache:/root/.cache/pip
    env_file:
      - .env
    environment:
      # Override workspace path to match container path
      - CLAWDBOT_WORKSPACE=/root/clawd
      # Permite instalações Python sem venv
      - PIP_BREAK_SYSTEM_PACKAGES=1
    ports:
      - "18789:18789"
    restart: unless-stopped
    command: clawdbot gateway --bind lan

volumes:
  apt-cache:
  pip-cache:
